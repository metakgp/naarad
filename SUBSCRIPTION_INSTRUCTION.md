# Naarad Subscription Instruction

Narada (Sanskrit: नारद, IAST: Nārada), or Narada Muni, is a sage-divinity, famous in Hindu traditions as a travelling musician and storyteller, who carries **news** and enlightening wisdom ([source](https://en.wikipedia.org/wiki/Narada)). Our naarad delivers news (noticies) to the KGP community.

## User Registration

1. Visit [Naarad Signup](https://naarad-signup.metakgp.org/) page
2. You will be prompted to enter your institute email
3. Once email is entered, you will receive a verification OTP on the provided email
4. Enter the OTP in the available field and click the `Verify` button
5. After a while, you will then receive a prompt on the screen saying `Credentials sent to your institute email`
6. Check your institute email for credentials and make sure to keep them safe for future use
7. Follow through [webapp user login](#user-login) step

> [!Tip]
> It is recommended to change the auto-generated password.

| ![image](https://github.com/metakgp/naarad/assets/86282911/f4e828c6-fa58-496b-bf09-7cb6cd7d2b09) | ![image](https://github.com/metakgp/naarad/assets/86282911/94e0acad-d05c-4640-a75d-debb3276abcc) |
| ---------------------------------- | -------------------------------- |
| ![image](https://github.com/metakgp/naarad/assets/86282911/1aaa2595-15c1-4530-8c91-e06c1790382f) | ![image](https://github.com/metakgp/naarad/assets/86282911/5a9ef215-e805-4621-a257-4a9613e9a895) |

## Webapp

### User Login

0. After following all the steps for [registering a user on naarad](#user-registration) you will be redirected to [Naarad Login](https://naarad.metakgp.org/login) page
1. You will be prompted to enter username and password, enter those which you just received on your institute email
2. Finally, press the `login` button, now you are authorised to access naarad and subscribe to limited topics

<div align="center">
  <img src="https://github.com/metakgp/naarad/assets/86282911/ab48f663-4f2c-41a5-95e6-c02a845cb368">
</div>

### Configuring Notification

Make sure to grant the webapp notification permission.

<div align="center">
  <img src="https://github.com/metakgp/naarad/assets/86282911/ca0a7afd-17c0-4749-9cba-a0688cbc8f6f">
</div>

#### Enabling WebPush

In order to receive notifications even if the [webapp's tab](https://naarad.metakgp.org) is closed, follow the steps below:

1. Click on `Settings` button on the left panel
2. Enable `Background Notifications` (4th option from top)

> [!Tip]
> To receive seamless real-time notifications, following configurations are recommended:
> 1. Make sure the `Minimum Priority` is set to `Any Priority`, in order to not miss any notification
> 2. Make sure the `Delete Notifications` is set to `Never`, in order to store old notifications

<div align="center">
  <img src="https://github.com/metakgp/naarad/assets/86282911/a1f80492-9a8d-4d91-9a9a-1dfa86ac0842">
</div>

### Subscribing to MFTP

#### Automatic

After completing [Naarad User Login](#user-login), visit https://naarad.metakgp.org/kgp-mftp and you will be automatically subscribed to MFTP aka CDC Noticeboard.

#### Manual

If the [automatic](#automatic) method doesn't work, then you can do it manually as described below:

1. Click on `+ Subscribe to topic` button on the left panel
2. Enter `kgp-mftp` in the text box and click `Subscrbe` button
3. In case you were not logged in, it will require for credentials, enter the ones you received during [user registration](#user-registration)

<div align="center">
  <img src="https://github.com/metakgp/naarad/assets/86282911/43d66861-b5ef-4776-a940-21565da7b5a0">
</div>

## Mobile Application (Android, iOS)

### Download NTFY application

<div class="mt-8 flex flex-wrap gap-x-3 gap-y-4">
  <a target="_blank" href="https://play.google.com/store/apps/details?id=io.heckel.ntfy">
    <img alt="Get it on Google Play" src="https://ntfy.sh/_next/static/media/badge-google.19268080.png" width="168" height="50" decoding="async" data-nimg="1" loading="lazy" style="color:transparent">
  </a>
  <a target="_blank" href="https://f-droid.org/en/packages/io.heckel.ntfy/">
    <img alt="Get it on F-Droid" src="https://ntfy.sh/_next/static/media/badge-fdroid.f6ae6646.png" width="168" height="50" decoding="async" data-nimg="1" loading="lazy" style="color:transparent">
  </a>
  <a target="_blank" href="https://apps.apple.com/us/app/ntfy/id1625396347">
    <img alt="Download on the App Store" src="https://ntfy.sh/_next/static/media/badge-apple.4bec723d.png" width="148" height="50" decoding="async" data-nimg="1" loading="lazy" style="color:transparent">
  </a>
</div>

### Subscribing to MFTP

0. Make sure to click `Enable Now` for the banner regarding `Switching to WebSockets...`
1. Click on `+` icon in bottom right corner
2. Enter topic name as: `kgp-mftp`
3. Check `Use another server`
4. Replace `https://ntfy.sh` with `https://naarad.metakgp.org`
5. Press the `Subscribe` button
6. It will now prompt you to Login, enter the credentials received during [user registration](#user-registration)
7. Click the `Login` button, you will be taken to the topic page

| ![](https://github.com/metakgp/naarad/assets/86282911/34db1e2a-f269-40fd-8e21-9a933f1ed8cb) | ![](https://github.com/metakgp/naarad/assets/86282911/2e6cb3df-d65b-41a0-bcf0-7623607bf56b) |
| ---------------------------------- | -------------------------------- |
| ![](https://github.com/metakgp/naarad/assets/86282911/0a65338a-705d-47dd-8fa7-e399e23f4908) | ![](https://github.com/metakgp/naarad/assets/86282911/7969077b-32bf-4087-ab46-a09c89c85cc7) |

### Configuring the topic

0. Once you [subscribe to the topic](#subscribing-to-mftp), then follow then configure the settings as below
1. Click on the three dots on top-right corner and click on `Subscription Settings`
2. Configure the settings as shown in the second image below

| ![](https://github.com/metakgp/naarad/assets/86282911/a3cfdff6-2267-4561-9c7c-bde645afe56f) | ![](https://github.com/metakgp/naarad/assets/86282911/4402c5e0-6a67-4381-af73-6cc01dede855) |
| ---------------------------------- | -------------------------------- |

### Downloading Attachment

Attachment URLs are protected by [heimdall](https://heimdall.metakgp.org/). Heimdall sessions are created when you authorise via your institute email, as done during steps 2,3,4 while [registering a user](#user-registration). Hence, it is not possible to directly dwonlaod the attachments via the mobile application, while, the process for the same on webapp is straightforward. Follow the steps below to download the attachment via your mobile devices.

1. Tap on the attachment banner
2. A context-menu will appear, tap on `Copy URL`. You will receive a toast message, saying `URL copied to clipboard`
3. Open your choice of browser on your mobile device and paste the copied URL
4. You will be redirected to heimdall. Authorise with your institute email as done during the steps 2,3,4 while [registering a user](#user-registration). This is a one time step
5. The pdf will be downloaded locally

| ![](https://github.com/user-attachments/assets/f1876107-fb80-4588-ab40-c80f51e07c1f) | ![](https://github.com/user-attachments/assets/68e5e414-4190-4fc9-9914-4c1d265c6c68) |
|-------|-------|
| ![](https://github.com/user-attachments/assets/1744c621-52a0-43a4-b3e2-bd745ce78678) | ![](https://github.com/user-attachments/assets/5911bdf1-1a98-4459-a938-5c4169aa0bfe) |

### Disabling Battery Optimisations

In order to receive unrestricted real-time notifications on the mobile applications, follow the steps below for your specifc device(s).

> [!Tip]
> It is also recommended to disable "Battery Saver" to not have any unwanted delay.

#### iOS

Enable `Background App Refresh` for the __ntfy__ app on both __Wifi & mobile data__.

> [!Note]
> Observe the following differences before watching the video:
> - Make sure the setting is enabled for both __Wifi & Mobile Data__
> - Make sure it is enabled for __NTFY__ app
> - If you don't find the setting as shown in the video, search for a similar setting for your version of iOS

Here's the general tutorial to [Turn On Background App Refresh in iOS](https://www.youtube.com/watch?v=QYh62JM-Aiw).

#### Android

Disable `Battery Optimisation` for the __ntfy__ app.

> [!Warning]
> This particular setting will differ from device to device. The place it is located at, the way it is written, everything might differ slightly from one vendor to another vendor. So make sure:
> - When you search on the web, you provide your device model - for better results
> - Search for a similar setting on your own for your device manually

Here are the general tutorials, to unrestrict background app activity:
- [From `APP INFO`](https://www.youtube.com/watch?v=QEkSJgurosE)
- [From `Settings`](https://www.youtube.com/watch?v=M5i6lD9zAXE)

> [!Note]
> Make sure you follow both the ways and see that both the methods are in sync (have the same thing - `Unrestricted Battery Usage`)

## Changing User Password

1. Click on `Account` on the left pane of the screen
2. Click on `pencil icon` on right of "password" entry
3. Fill the _current_, _new_ and _confirm_ password fields
4. Click on `Change Password` button

<div align="center">
  <img src="https://github.com/metakgp/naarad/assets/86282911/647f290d-51e8-4340-8033-61e47e326f74">
</div>

## Enforced Campus Signup and Login

Since, CDC period (for internships) starts during the summer vacations and majority of the students are not on campus during that time, [singup](#user-registration) and [login](#user-login) are open from any network. One day after the **CDC travel window** is over, following changes are implemented:
- User database is deleted
- __User Signup & Login__ are restricted, to be possible only via campus network
- Once signed up and logged in, via campus network, the app is functional on all networks

> [!Warning]
> Make sure you are connected to campus network, before following ahead in the documentation.

Users have to initiate the registration process again and receive new credentials. This time, just visit [https://naarad.metakgp.org/signup](https://naarad-signup.metakgp.org). You will receive the new credentials on your institute email within a few seconds. 

It's now time to re-login with your new credentials, in-order to do that first remove the previous sessions from your webapp and app.

### Webapp

1. Click on the account icon on top right corner
2. Logout the current user
3. Visit [Naarad Login](https://naarad.metakgp.org/login)

<div align="center">
  <img src="https://github.com/metakgp/naarad/assets/86282911/d20e5684-4831-439e-a81c-28a7f23aff9c">
</div>

### Mobile

1. Press the _three-dots_ on the top-right corner
2. Choose the `Settings` option from the context-menu
3. Select the `Manage Users` property in the _General_ section below
4. Press on the user corresponding to your institute email (auto-generated username, which you received on your email)
5. A dialogue will appear there, select the `Delete User` button
6. Now go back to the home screen, select the `kgp-mftp` topic and press the _three-dots_ there on the top-right corner
7. Choose the `Unsubscribe` option from the context-menu
8. A dialogue will appear the, select the `Delete Permanently`buttonthere
9. Now that the user has been removed properly, follow the [Subscribing to MFTP](#subscribing-to-mftp) section once again while being connected to the campus network

| ![](https://github.com/metakgp/naarad/assets/86282911/34a7e162-68b0-454e-98a5-b61bac62e898) | ![](https://github.com/metakgp/naarad/assets/86282911/4beb8bf5-bc28-4164-a4a4-f05f04644fe9) |
| ---------------------------------- | -------------------------------- |
| ![](https://github.com/metakgp/naarad/assets/86282911/6606ee7e-030f-48ec-b886-fe143bcbcbb7) | ![](https://github.com/metakgp/naarad/assets/86282911/3ed6ec9a-b57d-441c-8933-3365ebeba287) |
| ![](https://github.com/metakgp/naarad/assets/86282911/0829d4d6-fc88-4d24-8dbb-75810e800c40) | ![](https://github.com/metakgp/naarad/assets/86282911/cfb77e27-0e93-4897-9480-1530eaa67e38) |
| ![](https://github.com/metakgp/naarad/assets/86282911/8f366eb4-0cfb-4ee5-a272-8c0efe362d59) | ![](https://github.com/metakgp/naarad/assets/86282911/461f550d-9148-43a1-bc24-c29f1b47b271) |
